# =========================================================
# 0. 通用設定（每隻 worker 建議都要填）
# =========================================================
APP_ENV=dev                 # dev / prod / test ...
#LOG_LEVEL=INFO              # DEBUG / INFO / WARNING / ERROR
LOG_LEVEL=ERROR              # DEBUG / INFO / WARNING / ERROR

SITE_UID=s001              
DEVICE_UID=d0001            

# Connector Name = 你的表格裡的 Connector Name

# 同案場不可相同、注意大小寫
CONN_NAME=user_default      

# DRY-RUN 模式（未來若需要：true 時只印 log，不送 MQ / 不寫 DB）
DRY_RUN=false  # DRY-RUN 模式（未來若需要：true 時只印 log，不送 MQ / 不寫 DB）
# =========================================================
# 1. MNX / RabbitMQ：只走 cfg.json
# =========================================================
# MNXNexlib 專案根目錄
MNX_LIB_ROOT=C:\Users\ericc\iot
NEXCORE_DIR=${MNX_LIB_ROOT}\NexCore
# macOS 範例（暫時註解當參考與理解）：
# MNX_LIB_ROOT=/Users/eric/Documents/iot

# 要使用的 RabbitMQ 設定檔檔名
#   例如：rabbitmq_cfg.json（溫濕度）、rabbitmq_cfg_p.json（power meter）
RMQ_CFG_FILENAME=rabbitmq_cfg.json # 要換power meter 改rabbit_cfg_p.json
RMQ_CFG_PATH=${NEXCORE_DIR}\${RMQ_CFG_FILENAME}

# NexCore/xRabbit 會用到的完整路徑
RMQ_CFG_PATH=${MNX_LIB_ROOT}\NexCore\${RMQ_CFG_FILENAME}
# macOS 範例：
# RMQ_CFG_PATH=${MNX_LIB_ROOT}/NexCore/${RMQ_CFG_FILENAME}

# 給 RabbitMq 類別用的連線名稱（會出現在 log / Mongo.conn_name）
RMQ_CONN_NAME=${CONN_NAME}


# =========================================================
# 2. MQTT 連線資訊（若有 MQTT worker 再填）
# =========================================================
MQTT_HOST=
MQTT_PORT=1883

MQTT_USERNAME=
MQTT_PASSWORD=

# 建議帶上 site_uid / device_uid，方便辨識 client
MQTT_CLIENT_ID=abh-gw-${SITE_UID}-${DEVICE_UID}

# 訂閱 / 發佈主題（依 worker 角色填）
MQTT_SUB_TOPIC=
MQTT_PUB_TOPIC=

MQTT_QOS=1
MQTT_KEEPALIVE=60
MQTT_CLEAN_SESSION=true
MQTT_RECONNECT_DELAY=5       # 斷線重連間隔秒數


# =========================================================
# 3. Modbus TCP 連線資訊（照你表格欄位順序）
# =========================================================
# --- Connector 層級（對應你表格「設備1 / 設備2 / 設備3」那列） ---

MODBUS_CONNECTOR_NAME=${CONN_NAME}    # 欄位：Connector Name
MODBUS_PROTOCOL_TYPE=Modbus TCP       # 欄位：Protocol Type（自我紀錄用）

MODBUS_HOST=192.168.2.1             # 欄位：Host Name
MODBUS_PORT=3000                       # 欄位：Port
MODBUS_SLAVE_ID=1                     # 欄位：Slave ID（= Unit ID）
MODBUS_FUNCTION_CODE=3                # 欄位：Function（功能碼），0x03 = Read Holding Registers
# MODBUS_FIRST_REGISTER=40001           # 欄位：First Register（第一個暫存器，人類閱讀用）

# --- 測點定義（Register / Description / Device / Format / Attribute / Unit） ---
# 這裡是「至少一筆點位」的最小需求，你可以依需要開 1,2,3... 組。
# 之後程式可以用 *_1, *_2, ... 做 mapping。

# ► 點位 1
MODBUS_REGISTER_1=40001         # Register
MODBUS_COUNT_1 = 2                # 讀幾個
MODBUS_DESC_1=Voltage           # Description
MODBUS_DEVICE_1=power_meter     # Device
MODBUS_FORMAT_1=U16             # Format
MODBUS_ATTR_1=R                 # Attribute 可讀性 可讀(R)可寫(W)
MODBUS_UNIT_1=0.1              # Unit

# ► 點位 2（如果有）
# MODBUS_REGISTER_2=40002
# MODBUS_DESC_2=Current
# MODBUS_DEVICE_2=power_meter
# MODBUS_FORMAT_2=S16
# MODBUS_ATTR_2=R/W
# MODBUS_UNIT_2=1A

# ► 預留 點位 3…n
# MODBUS_TCP_REGISTER_3=
# MODBUS_TCP_DESC_3=
# MODBUS_TCP_DEVICE_3=
# MODBUS_TCP_FORMAT_3=
# MODBUS_TCP_ATTR_3=
# MODBUS_TCP_UNIT_3=

# --- 輪詢與 Timeout（這些不是你表裡的欄位，但對 worker 必要） ---
READ_INTERVAL_SEC=2          # 這隻 worker 的輪詢頻率（秒）
MODBUS_TIMEOUT=2             # Modbus 通訊 Timeout（秒）


# =========================================================
# 4. Modbus RTU (Serial) 連線資訊（例如 PZEM-003/017）
# =========================================================
SERIAL_PORT=               # Windows: COM3 / COM4...

# macOS 範例：
# SERIAL_PORT=/dev/cu.usbserial-0001
RTU_BAUD=4800
RTU_BYTESIZE=8
RTU_PARITY=N
RTU_STOPBITS=2
RTU_TIMEOUT=2

RTU_UNIT=1
RTU_READ_INTERVAL_SEC=2      # 若 RTU 與 TCP 頻率要分開，可用這個



# =========================================================
# 5. OPC UA 連線資訊（若有 OPC UA worker 再填）
# =========================================================
OPCUA_ENDPOINT_URL=                 # 必填：Server endpoint
OPCUA_SUBSCRIBE_NODE_IDS=           # 必填：至少一個訂閱 Node，逗號分隔
OPCUA_PUBLISH_INTERVAL_MS=1000      # 必填：訂閱回傳間隔（毫秒）

# 常見必要（依 server 而定）
OPCUA_SECURITY_MODE=None
OPCUA_SECURITY_POLICY=None
OPCUA_USERNAME=
OPCUA_PASSWORD=

# 可選
OPCUA_SESSION_TIMEOUT_MS=60000


# =========================================================
# 6. Storage / Mongo（也只走 cfg.json）
# =========================================================
# Storage 設定檔檔名（放在 NexSto 底下，例如 storage_cfg.json）
STO_CFG_FILENAME=storage_cfg.json
# cfg.json 完整路徑
STO_CFG_PATH=$NexSto\${STO_CFG_FILENAME}
# macOS 範例：
# STO_CFG_PATH=${MNX_LIB_ROOT}/NexSto/${STO_CFG_FILENAME}
# 給 xMongo / consumer 用的連線名稱（寫進 log / Mongo.conn_name）
STO_CONN_NAME=${CONN_NAME}


# =========================================================
# 7. 其他共用參數
# =========================================================
#TIMEZONE=Asia/Taipei
#CLOCK_OFFSET_SEC=0           # 若 Gateway 時間有固定誤差，程式可用這個做修正

# Worker 名稱與版本（寫進 envelope）
WORKER_NAME= s001d0001
WORKER_VERSION=1.0.0
